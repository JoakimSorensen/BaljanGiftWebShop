<link href="/static/css/order_info.css" rel="stylesheet" type="text/css">


<h1 id="order_label" align="center">Skriv in ordernummer för att visa order</h1>

    <form id="token-form"  class="flex-form" method="get">
            <div align="center" style="margin-top: 10%">
                <div align="center" style="width: 53%">
                    <input id="token_input" class="token-input" type="text" name="token" placeholder="Ordernummer" style="font-size: 3.5vw;
                     border: 0; width: 80%; white-space: nowrap; border-bottom: 2px solid black">
                    <input id="submit_btn" type="submit" value="Sök" style="background-color: #38A7E5; font-size: 250%;
                    color: #FFFFFF; border: 0; height: 200%; padding-bottom: 1%">
                    <p id="error-text" style="color: crimson; font-size: 1.5vw; padding-left: 1vw" align="left">Ordernumret du angav existerar ej!</p>
                </div>
            </div>

    </form>

    <div id="token-result">
        <h1 id="text1">Här finns lite text</h1>
        <h1>Här finns lite mer text</h1>
    </div>



<script>
    $(document).ready(function() {
        $("#error-text").hide();
        $("#token-result").hide();
    });


    $("#token-form").submit(function(ev){

        console.log("går in i script");
        ev.preventDefault();
        var token_from_input = $("#token_input").val();
        var info = [];
        var url = "api/v1/order_token/" + token_from_input;

        $.getJSON(url, function(data){
            if(data === "error"){
                $("#error-text").show();
                console.log("failure")
            }else{
            console.log("successs")
            $("#token-result").show();
            handleData(data);
            }
        });
    });

    function handleData(data){
            var receiver_data="null";
            var giftbox_val = 0;


         $.each(data, function( key, val ) {
            if(key==="giftbox_id"){
                giftbox_val = val;
            }else if(key==="receiver_id"){
                var receiver_val = val;
                receiver_data = getReceiverData(receiver_val);
            }else if(key==="date"){
                var date_val = val;
            }else if(key==="message"){
                var msg_val = val;
            }else if(key==="price"){
                var price_val = val;
            }else if(key==="status"){
                var status_val = val;
            }
            });

            var gift_data = getGiftboxData(giftbox_val);

         /*console.log(gift_data['name']);*/
         console.log(gift_data);
    }

    function getGiftboxData(val) {
        var url = "api/v1/giftbox/" + val;
        $.getJSON(url, function (data) {
            return data;
        });
    }

    function getReceiverData(val) {
        var url = "api/v1/receiver/" + val;
        $.getJSON(url, function (data) {
            return data;
        });
    }

</script>

